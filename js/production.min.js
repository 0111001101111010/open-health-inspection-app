"use strict";var openHealthDataApp=angular.module("openHealthDataApp",["ngRoute","openHealthDataAppControllers","ngAnimate","openHealthDataServices","google-maps"]);openHealthDataApp.config(["$routeProvider",function(a){a.when("/",{templateUrl:"partials/listView.html",controller:"restaurantListCtrl"}).when("/vendor/:id",{templateUrl:"partials/restaurantDetailView.html",controller:"restaurantDetailCtrl"}).otherwise({redirectTo:"/"})}]);var openHealthDataAppControllers=angular.module("openHealthDataAppControllers",[]);openHealthDataAppControllers.controller("restaurantListCtrl",["$scope","$rootScope","$http","Geosearch","Data","Search",function(a,b,c,d,e,f){a.query=e.query,a.map={center:{latitude:36.84701,longitude:-76.29243},zoom:17},a.showPosition=function(b){a.map.center.latitude=b.coords.latitude,a.map.center.longitude=b.coords.longitude},a.showError=function(){console.log("error")},a.getLocation=function(b){navigator.geolocation?navigator.geolocation.getCurrentPosition(a.showPosition,a.showError):a.error="Geolocation is not supported by this browser.",b()},a.getLocation(function(){a.restaurants=d.query({lat:a.map.center.latitude,lon:a.map.center.longitude,dist:1e3})}),b.$on("searchFire",function(){console.log("searchFire heard."),console.log("Searching for "+e.query),a.query=f.query({searchString:e.query})})}]),openHealthDataAppControllers.controller("restaurantDetailCtrl",["$scope","$routeParams","$http",function(a,b,c){c.jsonp("http://api.ttavenner.com/inspections/"+b.id+"?callback=JSON_CALLBACK").success(function(b){a.restaurants=b,console.log(a.restaurants)}),a.map={center:{latitude:90.84701,longitude:90.29243},zoom:18}}]),openHealthDataAppControllers.controller("searchCtrl",["$scope","$rootScope","Search","Data",function(a,b,c,d){a.nameSearch=function(){console.log("Searching for "+a.query+"."),d.query=a.query,b.$broadcast("searchFire")},a.query=d.query}]);var openHealthDataServices=angular.module("openHealthDataServices",["ngResource"]);openHealthDataServices.factory("Vendors",["$resource",function(a){return a("http://api.ttavenner.com/vendors",{},{query:{method:"JSONP",params:{callback:"JSON_CALLBACK"}}})}]),openHealthDataServices.factory("Geosearch",["$resource",function(a){return a("http://api.ttavenner.com/vendors/geosearch/:lat/:lon/:dist",{},{query:{method:"JSONP",params:{lat:"36",lon:"-72",dist:"1000",callback:"JSON_CALLBACK"}}})}]),openHealthDataServices.factory("Search",["$resource",function(a){return a("http://api.ttavenner.com/vendors/textsearch/:searchString",{},{query:{method:"JSONP",params:{searchString:"",callback:"JSON_CALLBACK"}}})}]),openHealthDataServices.factory("Data",["$resource",function(){return{query:"I'm data from a service."}}]);